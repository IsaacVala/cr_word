{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/commands/commands.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","fileName","onItemAttachmentsChangedHandler","event","console","log","attachmentDetails","attachmentStatus","undefined","completed","item","Office","context","mailbox","options","asyncContext","currentItem","getAttachmentsAsync","getAttachmentsCallback","result","length","getAttachmentContentAsync","id","handleAttachmentsCallback","format","MailboxEnums","AttachmentContentFormat","Base64","base64","content","notificationMessages","addAsync","type","ItemNotificationMessageType","ProgressIndicator","message","asyncResult","status","AsyncResultStatus","Succeeded","ciphertext","CryptoJS","AES","encrypt","toString","encryptedData","base64EncryptedData","window","btoa","encryptedFileName","addFileAttachmentFromBase64Async","originalText","decrypt","enc","Utf8","decryptedFileName","removeAsync","InformationalMessage","icon","persistent","decryptAttachment","encryptAttachment","ex","error","Eml","ICalendar","Url","initialize","reason","actions","associate","InsightMessage","actionText","actionType","ActionType","ShowTaskPane","commandId","contextData","originalAppointmentDate","start","getAsync","end","asyncResult2","localStorage","setItem","JSON","stringify","addAsyncResult","totalOptionalAttendees","totalRequiredAttendees","totalDistributionLists","changedRecipientFields","requiredAttendees","apptRequiredAttendees","currentDistributionLists","filter","attendee","recipientType","optionalAttendees","apptOptionalAttendees","asyncResult3","asyncResultDLs","replaceAsync","asyncResult4","anyExistingWarningMessages","getAllAsync","asyncResult5","warningMessage","asyncResult6","dir","parse","getItem","originalAppointmentDateStartDate","Date","originalAppointmentDateStartEnd","convertedToLocalStartUtc","convertToLocalClientTime","convertedToLocalEndUtc","convertedToLocalStart","year","month","date","hours","minutes","convertedToLocalEnd","index","originalDateMessage","toLocaleDateString","toLocaleTimeString","dateStampMessageSet"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,K,oBC3ErD,IAAIC,EAmOJ,SAASC,EAAgCC,GAGvC,GADAC,QAAQC,IAAI,oCAAsCF,EAAMG,kBAAkB9B,KAAO,KAAO2B,EAAMI,iBAAmB,KAC7GJ,EAAMG,kBAAkB9B,MAAxB,UAnO4B,cAmO5B,OAA+DyB,GAAnE,CAKA,QAAiBO,IAAbP,EAGF,OAFAG,QAAQC,IAAI,mEACZF,EAAMM,YAKRR,EAAWE,EAAMG,kBAAkB9B,KACnC,IAAIkC,EAAOC,OAAOC,QAAQC,QAAQH,KAC9BI,EAAU,CAAEC,aAAc,CAAEC,YAAaN,IAC7CA,EAAKO,oBAAoBH,EAASI,QAbhCf,EAAMM,YAkBV,SAASS,EAAuBC,GAC9B,GAAIA,EAAOjC,MAAMkC,OAAS,EACxB,IAAKnD,EAAI,EAAGA,EAAIkD,EAAOjC,MAAMkC,OAAQnD,IAEnCkD,EAAOJ,aAAaC,YAAYK,0BAA0BF,EAAOjC,MAAMjB,GAAGqD,GAAIC,GAQpF,SAASA,EAA0BJ,GAKjC,OAHAf,QAAQC,IAAR,6DAAkEc,EAAOjC,MAAMsC,SAGvEL,EAAOjC,MAAMsC,QACnB,KAAKb,OAAOc,aAAaC,wBAAwBC,OAK/C,IAAIb,EAAU,CAAE,aAAgB,CAAEc,OAAQT,EAAOjC,MAAM2C,UACvDlB,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBC,SAAS,wBAAyB,CACjFC,KAAMrB,OAAOc,aAAaQ,4BAA4BC,kBACtDC,QAAS,0BAAF,OAA4BlC,EAA5B,iCACNa,GAAS,SAASsB,GAEjB,GAAIA,EAAYC,SAAW1B,OAAO2B,kBAAkBC,UAClD,IACE,IAAIC,EAAaC,SAASC,IAAIC,QAAQP,EAAYrB,aAAaa,OAxR3D,kBAwR8EgB,WAElFxC,QAAQC,IAAR,oEAAyEJ,EAAzE,SA0Cd,SAA2B4C,GACzBzC,QAAQC,IAAR,gDAAqDJ,EAArD,UAGA,IAAI6C,EAAsBC,OAAOC,KAAKH,GAClCI,EAAoB,GAAH,OAxUW,cAwUX,OAAkChD,GAKvDG,QAAQC,IAAR,sDAA2D4C,EAA3D,SACAtC,OAAOC,QAAQC,QAAQH,KAAKwC,iCAC1BJ,EACAG,GACA,SAAUb,GACRhC,QAAQC,IAAR,2DAAgE4C,EAAhE,yBAUN,SAA2BJ,GACzBzC,QAAQC,IAAR,gDAAqDJ,EAArD,UAEA,IACIkD,EADQV,SAASC,IAAIU,QAAQP,EAhWjB,kBAiWSD,SAASH,SAASY,IAAIC,MAC3CC,EAAoB,GAAH,OAhWW,cAgWX,OAAkCtD,GAGvDG,QAAQC,IAAR,sDAA2DkD,EAA3D,SACA5C,OAAOC,QAAQC,QAAQH,KAAKwC,iCAC1BC,EACAI,GACA,SAAUnB,GACRhC,QAAQC,IAAR,2DAAgEkD,EAAhE,MAGA5C,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB0B,YAAY,yBAAyB,SAAUrC,GAC9Ff,QAAQC,IAAI,iCAEZM,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBC,SAAS,mBAAoB,CAC5EC,KAAMrB,OAAOc,aAAaQ,4BAA4BwB,qBACtDtB,QAAS,QAAF,OAAUlC,EAAV,qGACPyD,KAAM,aACNC,YAAY,UA/BhBC,CAAkBf,MA1DVgB,CAAkBrB,GAEpB,MAAMsB,GACJ1D,QAAQ2D,MAAR,8CAAqDD,IACrDnD,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB0B,YAAY,yBAAyB,SAAUrC,GACtGf,QAAQC,IAAI,yCAIRD,QAAQ2D,MAAR,8DAAqE3B,EAAYC,YAGvF,MAOF,KAAK1B,OAAOc,aAAaC,wBAAwBsC,IAE/C5D,QAAQC,IAAI,4BACZ,MACF,KAAKM,OAAOc,aAAaC,wBAAwBuC,UAE/C7D,QAAQC,IAAI,kCACZ,MACF,KAAKM,OAAOc,aAAaC,wBAAwBwC,IAE/C9D,QAAQC,IAAI,qCACZ,MACF,QAEED,QAAQC,IAAI,yCAxTlBM,OAAOwD,WAAa,SAAUC,KA2c9BzD,OAAO0D,QAAQC,UAAU,2BAjZzB,WAmUE3D,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBC,SAAS,mCAAoC,CAC5FC,KAAMrB,OAAOc,aAAaQ,4BAA4BsC,eACtDpC,QAAS,gGACTuB,KAAM,aACNW,QAAS,CACP,CACEG,WAAY,iBACZC,WAAY9D,OAAOc,aAAaiD,WAAWC,aAC3CC,UAAW,2BACXC,YAAa,cAsErBlE,OAAO0D,QAAQC,UAAU,+BAvczB,SAAqCnD,GACnCf,QAAQC,IAAI,2CACZ,IAAIyE,EAA0B,GAG9BnE,OAAOC,QAAQC,QAAQH,KAAKqE,MAAMC,UAAS,SAAC5C,GAC1C,GAAIA,EAAYC,SAAW1B,OAAO2B,kBAAkBC,UAGlD,OAFAnC,QAAQ2D,MAAR,qCAA4C3B,EAAY2B,MAAM5B,eAC9DC,EAAYrB,aAAaN,YAG3BL,QAAQC,IAAR,8BAAmC+B,EAAYlD,QAC/C4F,EAAwBC,MAAQ3C,EAAYlD,MAE5CyB,OAAOC,QAAQC,QAAQH,KAAKuE,IAAID,UAAS,SAACE,GACxC,GAAIA,EAAa7C,SAAW1B,OAAO2B,kBAAkBC,UAGnD,OAFAnC,QAAQ2D,MAAR,qCAA4CmB,EAAanB,MAAM5B,eAC/D+C,EAAanE,aAAaN,YAG5BL,QAAQC,IAAR,4BAAiC6E,EAAahG,QAC9C4F,EAAwBG,IAAMC,EAAahG,MAC3CiG,aAAaC,QAAQ,mBAAoBC,KAAKC,UAAUR,IAKxDnE,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBC,SAC/C,mCACA,CACEC,KAAMrB,OAAOc,aAAaQ,4BAA4BsC,eACtDpC,QAAS,gGACTuB,KAAM,aACNW,QAAS,CACP,CACEG,WAAY,iBACZC,WAAY9D,OAAOc,aAAaiD,WAAWC,aAC3CC,UAAW,uBACXC,YAAa,WAInB,SAAUU,GACRpE,EAAOV,wBA6ZjBE,OAAO0D,QAAQC,UAAU,qCAAsCpE,GAC/DS,OAAO0D,QAAQC,UAAU,yCAA0CpE,GACnES,OAAO0D,QAAQC,UAAU,wCA7YzB,SAA8CnE,GAM5C,IAAIqF,EAAyB,EACzBC,EAAyB,EACzBC,EAAyB,EAE7BtF,QAAQC,IAAR,wDAA6DF,EAAM6B,KAAnE,sCAAqG7B,EAAMwF,yBAE3GhF,OAAOC,QAAQC,QAAQH,KAAKkF,kBAAkBZ,UAAS,SAAU5C,GAC/D,GAAIA,EAAYC,SAAW1B,OAAO2B,kBAAkBC,UAAW,CAC7D,IAAIsD,EAAwBzD,EAAYlD,MAExCuG,EAAyBI,EAAsBzE,OAC/ChB,QAAQC,IAAR,mCAAwCoF,IACxCK,yBAA2BD,EAAsBE,QAAO,SAASC,GAAU,MAAkC,qBAA3BA,EAASC,iBACnD,IAApCH,yBAAyB1E,SAC3BsE,GAAkDI,yBAAyB1E,QAG7ET,OAAOC,QAAQC,QAAQH,KAAKwF,kBAAkBlB,UAAS,SAAUE,GAG/D,GAFA9E,QAAQC,IAAR,mBAAwB6E,EAAa7C,SAEjC6C,EAAa7C,SAAW1B,OAAO2B,kBAAkBC,UAAW,CAC9D,IAAI4D,EAAwBjB,EAAahG,MACzCsG,EAAyBW,EAAsB/E,OAC/C0E,yBAA2BK,EAAsBJ,QAAO,SAASC,GAAU,MAAkC,qBAA3BA,EAASC,iBACnD,IAApCH,yBAAyB1E,SAC3BsE,GAAkDI,yBAAyB1E,aAI7EhB,QAAQ2D,MAAR,wDAA+DmB,EAAanB,QAG9E3D,QAAQC,IAAR,mCAAwCqF,IAET,IAA3BF,GAA2D,IAA3BC,EAElC9E,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB0B,YAC/C,mBACA,MACA,SAAU4C,GACJA,EAAa/D,SAAW1B,OAAO2B,kBAAkBC,WACnDnC,QAAQC,IAAR,gCAAqC+F,EAAa/D,SAElD1B,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB0B,YAC/C,0BACA,MACA,SAAU6C,GACJA,EAAehE,SAAW1B,OAAO2B,kBAAkBC,WACrDnC,QAAQC,IAAR,kCAAuCgG,EAAehE,SACtDlC,EAAMM,cAGNL,QAAQ2D,MAAR,8DAAqEsC,EAAetC,QACpF5D,EAAMM,kBAMZL,QAAQ2D,MAAR,8DAAqEqC,EAAarC,QAClF5D,EAAMM,gBAMZE,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBwE,aAC/C,mBACA,CACEtE,KAAMrB,OAAOc,aAAaQ,4BAA4BwB,qBACtDtB,QAAS,wBAAF,OAA0BsD,EAA1B,yBAAiED,EAAjE,uBACP9B,KAAM,aACNC,YAAY,IAEd,SAAU4C,GACR,GAAIA,EAAalE,SAAW1B,OAAO2B,kBAAkBC,UAAW,CAC9D,IAAIiE,GAA6B,EAEjC7F,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB2E,aAAY,SAAUC,GAGnE,IA0BIC,GA5BNvG,QAAQC,IAAR,+CAAoDqG,EAAarE,SAC7DqE,EAAarE,SAAW1B,OAAO2B,kBAAkBC,WAEJ,IADTmE,EAAaxH,MAAM6G,QAAO,SAAA5D,GAAO,MAAoB,4BAAhBA,EAAQ3C,OAC/C4B,SAElCoF,GAA6B,GAI/BpG,QAAQ2D,MAAR,8DAAqE2C,EAAa3C,SAGrD,IAA3B2B,IAA+D,IAA/Bc,GAClC7F,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB0B,YAC/C,0BACA,MACA,SAAUoD,GACJA,EAAavE,SAAW1B,OAAO2B,kBAAkBC,UAInDnC,QAAQ2D,MAAR,8DAAqE6C,EAAa7C,QAHlF5D,EAAMM,eASiB,IAA3BiF,IAGAiB,EAD6B,IAA3BjB,EACe,gGAEA,iCAAH,OAAoCA,EAApC,mEAGhB/E,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBwE,aAC/C,0BACA,CACEtE,KAAMrB,OAAOc,aAAaQ,4BAA4BwB,qBACtDtB,QAASwE,EACTjD,KAAM,aACNC,YAAY,IAEd,WACEvD,QAAQC,IAAI,QACZF,EAAMM,gBAKVN,EAAMM,oBAKVL,QAAQ2D,MAAR,+DAAsEwC,EAAaxC,mBAO7F3D,QAAQ2D,MAAR,2CAAkD3B,EAAYC,SAC9DD,EAAY3B,kBA0PlBE,OAAO0D,QAAQC,UAAU,mCAjEzB,SAAyCnE,GAEvCC,QAAQyG,IAAI1G,GACZC,QAAQyG,IAAI1G,EAAM6B,MAClB5B,QAAQyG,IAAI1G,EAAM4E,OAClB3E,QAAQyG,IAAI1G,EAAM8E,KAElB,IAAIH,EAA0BO,KAAKyB,MAAM3B,aAAa4B,QAAQ,qBAC1DC,EAAmC,IAAIC,KAAKnC,EAAwBC,OACpEmC,EAAkC,IAAID,KAAKnC,EAAwBG,KACnEkC,EAA2BxG,OAAOC,QAAQC,QAAQuG,yBAAyBJ,GAC3EK,EAAyB1G,OAAOC,QAAQC,QAAQuG,yBAAyBF,GACzEI,EAAwB,IAAIL,KAC9BE,EAAyBI,KACzBJ,EAAyBK,MACzBL,EAAyBM,KACzBN,EAAyBO,MACzBP,EAAyBQ,SAEvBC,EAAsB,IAAIX,KAC5BI,EAAuBE,KACvBF,EAAuBG,MACvBH,EAAuBI,KACvBJ,EAAuBK,MACvBL,EAAuBM,SAGzBhH,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqB2E,aAAY,SAAUrE,GAErE,GADAhC,QAAQC,IAAR,8CAAmD+B,EAAYC,SACrC,UAAtBD,EAAYC,OACd,IAAK,IAAIwF,EAAQ,EAAGA,EAAQzF,EAAYlD,MAAMkC,OAAQyG,IAAS,CAE7D,GAAoB,gBADJzF,EAAYlD,MAAM2I,GACtBrI,IAGV,YADAW,EAAMM,UAMZ,IAAIqH,EAAsB,+BAAH,OAAkCR,EAAsBS,qBAAxD,YAAgFT,EAAsBU,qBAAtG,mBAAqIJ,EAAoBG,qBAAzJ,YAAiLH,EAAoBI,sBAC5NrH,OAAOC,QAAQC,QAAQH,KAAKoB,qBAAqBwE,aAC/C,cACA,CACEtE,KAAMrB,OAAOc,aAAaQ,4BAA4BwB,qBACtDtB,QAAS2F,EACTpE,KAAM,aACNC,YAAY,IAEd,SAAUvB,GACRhC,QAAQC,IAAI,8CACZD,QAAQyG,IAAIzE,GACZ6F,qBAAsB,EACtB9H,EAAMM","file":"commands.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 386);\n","/*\r\n * Copyright (c) Eric Legault Consulting Inc.\r\n * Licensed under the MIT license.\r\n*/\r\n\r\n//TEST In Outlook desktop\r\n/* eslint-disable no-undef */ //For Office objects\r\nvar fileName;\r\nconst secretKey = \"secret key 123\";\r\nconst encryptedAttachmentPrefix = \"encrypted_\";\r\nconst decryptedAttachmentPrefix = \"decrypted_\";\r\n// eslint-disable-next-line no-unused-vars\r\nOffice.initialize = function (reason) {};\r\n/**\r\n * Method that fires when a appointment is being created or edited\r\n * @param {Office.AsyncResult} result default: Office.AsyncResult\r\n */\r\nfunction onAppointmentComposeHandler(result) {\r\n  console.log(\"onAppointmentComposeHandler(): entered!\");\r\n  let originalAppointmentDate = {};\r\n\r\n  // showInfoBarForSampleInstructions();\r\n  Office.context.mailbox.item.start.getAsync((asyncResult) => {\r\n    if (asyncResult.status !== Office.AsyncResultStatus.Succeeded) {\r\n      console.error(`Action failed with message ${asyncResult.error.message}`);\r\n      asyncResult.asyncContext.completed();\r\n      return;\r\n    }\r\n    console.log(`Appointment starts: ${asyncResult.value}`);\r\n    originalAppointmentDate.start = asyncResult.value;\r\n\r\n    Office.context.mailbox.item.end.getAsync((asyncResult2) => {\r\n      if (asyncResult2.status !== Office.AsyncResultStatus.Succeeded) {\r\n        console.error(`Action failed with message ${asyncResult2.error.message}`);\r\n        asyncResult2.asyncContext.completed();\r\n        return;\r\n      }\r\n      console.log(`Appointment ends: ${asyncResult2.value}`);\r\n      originalAppointmentDate.end = asyncResult2.value;\r\n      localStorage.setItem(\"appointment_info\", JSON.stringify(originalAppointmentDate));\r\n      // result.completed();\r\n      //NOTE: Clicking the \"Show Task Pane\" link in the InfoBar doesn't work. It is currently 'in backlog' status: https://github.com/OfficeDev/office-js/issues/2125\r\n      //NOTE: actions array only applicable to insightMessage types\r\n      //https://docs.microsoft.com/en-us/javascript/api/outlook/office.notificationmessages?view=outlook-js-preview\r\n      Office.context.mailbox.item.notificationMessages.addAsync(\r\n        \"showInfoBarForSampleInstructions\",\r\n        {\r\n          type: Office.MailboxEnums.ItemNotificationMessageType.InsightMessage, //\"insightMessage\"\r\n          message: \"Open the Task Pane for details about running the Outlook Event-based Activation Sample Add-in\",\r\n          icon: \"Icon.16x16\",\r\n          actions: [\r\n            {\r\n              actionText: \"Show Task Pane\",\r\n              actionType: Office.MailboxEnums.ActionType.ShowTaskPane, //\"showTaskPane\"\r\n              commandId: \"appOrgTaskPaneButton\",\r\n              contextData: \"{''}\",\r\n            },\r\n          ],\r\n        },\r\n        function (addAsyncResult) {\r\n          result.completed();\r\n        }\r\n      );\r\n    });\r\n  });\r\n}\r\n/**\r\n * Method that fires when an email is being created \r\n * @param {Office.AsyncResult} result default: Office.AsyncResult\r\n */\r\nfunction onMessageComposeHandler() {\r\n  //Reminder to open the TaskPane\r\n  showInfoBarForSampleInstructions();\r\n}\r\n/**\r\n * Method that fires when an attendee is added or removed from an appointment\r\n * @param {Office.AsyncResult} result default: Office.AsyncResult\r\n */\r\nfunction onAppointmentAttendeesChangedHandler(event) {\r\n  //https://docs.microsoft.com/en-us/javascript/api/outlook/office.recipientschangedeventargs?view=outlook-js-preview&preserve-view=true\r\n\r\n  //NOTE: Must call event.completed() when any logic below is finished!\r\n  //Add-in launch-event handlers are expected to be short-running, lightweight, and as noninvasive as possible. After activation, your add-in will time out within approximately 300 seconds, the maximum length of time allowed for running event-based add-ins. To signal that your add-in has completed processing a launch event, we recommend you have the associated handler call the event.completed method. (Note that code included after the event.completed statement is not guaranteed to run.) Each time an event that your add-in handles is triggered, the add-in is reactivated and runs the associated event handler, and the timeout window is reset. The add-in ends after it times out, or the user closes the compose window or sends the item.\r\n\r\n  var totalOptionalAttendees = 0;\r\n  var totalRequiredAttendees = 0;\r\n  var totalDistributionLists = 0;\r\n\r\n  console.log(`onAppointmentAttendeesChangedHandler() type = ${event.type}; changedRecipientFields = ${event.changedRecipientFields}`);\r\n\r\n  Office.context.mailbox.item.requiredAttendees.getAsync(function (asyncResult) {\r\n    if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\r\n      var apptRequiredAttendees = asyncResult.value;\r\n      //BUG 10/9/2021 On Outlook for Windows, when adding the first attendee it is also picking up a second attendee (possibly the sender)\r\n      totalRequiredAttendees = apptRequiredAttendees.length;\r\n      console.log(`totalRequiredAttendees = ${totalRequiredAttendees}`);\r\n      currentDistributionLists = apptRequiredAttendees.filter(function(attendee){return attendee.recipientType === \"distributionList\";});\r\n      if (currentDistributionLists.length !== 0){\r\n        totalDistributionLists = totalDistributionLists + currentDistributionLists.length;\r\n      }     \r\n\r\n      Office.context.mailbox.item.optionalAttendees.getAsync(function (asyncResult2) {\r\n        console.log(`status = ${asyncResult2.status}`);\r\n\r\n        if (asyncResult2.status === Office.AsyncResultStatus.Succeeded) {\r\n          var apptOptionalAttendees = asyncResult2.value;          \r\n          totalOptionalAttendees = apptOptionalAttendees.length;\r\n          currentDistributionLists = apptOptionalAttendees.filter(function(attendee){return attendee.recipientType === \"distributionList\";});\r\n          if (currentDistributionLists.length !== 0){\r\n            totalDistributionLists = totalDistributionLists + currentDistributionLists.length;\r\n          }          \r\n          \r\n        } else {\r\n          console.error(`Error with item.optionalAttendees.getAsync(): ${asyncResult2.error}`);\r\n        }\r\n\r\n        console.log(`totalDistributionLists = ${totalDistributionLists}`);\r\n\r\n        if (totalOptionalAttendees === 0 && totalRequiredAttendees === 0) {\r\n          //Remove the info bar with the recipients tally and any distribution list warnings if there are no longer any recipients\r\n          Office.context.mailbox.item.notificationMessages.removeAsync(\r\n            \"attendeesChanged\",\r\n            null,\r\n            function (asyncResult3) {\r\n              if (asyncResult3.status === Office.AsyncResultStatus.Succeeded) {\r\n                console.log(`asyncResult3.status = ${asyncResult3.status}`);\r\n\r\n                Office.context.mailbox.item.notificationMessages.removeAsync(\r\n                  \"distributionListWarning\",\r\n                  null,\r\n                  function (asyncResultDLs) {\r\n                    if (asyncResultDLs.status === Office.AsyncResultStatus.Succeeded) {\r\n                      console.log(`asyncResultDLs.status = ${asyncResultDLs.status}`);                      \r\n                      event.completed(); //NOTE: Must call!                            \r\n                    } else {\r\n                      //REVIEW: This can happen if there are no more warning messages. Not sure if this is a logic bug or expected. Should consider making a notificationMessages.getAllAsync call like below?\r\n                      console.error(`Error with item.notificationMessages.removeAsync(): ${asyncResultDLs.error}`);\r\n                      event.completed(); //NOTE: Must call!                            \r\n                    }\r\n                  }\r\n                );\r\n\r\n              } else {\r\n                console.error(`Error with item.notificationMessages.removeAsync(): ${asyncResult3.error}`);\r\n                event.completed(); //NOTE: Must call!\r\n              }\r\n            }\r\n          );\r\n        } else \r\n        {\r\n          Office.context.mailbox.item.notificationMessages.replaceAsync(\r\n            \"attendeesChanged\",\r\n            {\r\n              type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n              message: `Your appointment has ${totalRequiredAttendees} required and ${totalOptionalAttendees} optional attendees`,\r\n              icon: \"Icon.16x16\",\r\n              persistent: false,\r\n            },\r\n            function (asyncResult4) {\r\n              if (asyncResult4.status === Office.AsyncResultStatus.Succeeded) {  \r\n                var anyExistingWarningMessages = false;\r\n  \r\n                Office.context.mailbox.item.notificationMessages.getAllAsync(function (asyncResult5) {\r\n                  console.log(`getAllAsync(): asyncResult5.status = ${asyncResult5.status}`);\r\n                  if (asyncResult5.status === Office.AsyncResultStatus.Succeeded) {\r\n                    let distributionListWarningMessages = asyncResult5.value.filter(message => message.key === \"distributionListWarning\");\r\n                    if (distributionListWarningMessages.length !== 0)\r\n                    {\r\n                      anyExistingWarningMessages = true;\r\n                    }\r\n                  }\r\n                  else {\r\n                    console.error(`Error with item.notificationMessages.getAllAsync(): ${asyncResult5.error}`);\r\n                  }\r\n\r\n                  if (totalDistributionLists === 0 && anyExistingWarningMessages === true) {                    \r\n                    Office.context.mailbox.item.notificationMessages.removeAsync(\r\n                      \"distributionListWarning\",\r\n                      null,\r\n                      function (asyncResult6) {\r\n                        if (asyncResult6.status === Office.AsyncResultStatus.Succeeded) {;\r\n                          event.completed();\r\n                          return;\r\n                        } else {\r\n                          console.error(`Error with item.notificationMessages.removeAsync(): ${asyncResult6.error}`);\r\n                        }\r\n                      }\r\n                    );\r\n                  }\r\n    \r\n                  if (totalDistributionLists !== 0) {\r\n                    var warningMessage;\r\n                    if (totalDistributionLists === 1) {\r\n                      warningMessage = `Warning! Your appointment has a distribution list! Make sure you have chosen the correct one!`;\r\n                    } else {\r\n                      warningMessage = `Warning! Your appointment has ${totalDistributionLists} distribution lists! Make sure you have chosen the correct one!`;\r\n                    }    \r\n\r\n                    Office.context.mailbox.item.notificationMessages.replaceAsync(\r\n                      \"distributionListWarning\",\r\n                      {\r\n                        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n                        message: warningMessage,\r\n                        icon: \"Icon.16x16\",\r\n                        persistent: false\r\n                      },\r\n                      function () {\r\n                        console.log(\"done\");                      \r\n                        event.completed(); //NOTE: Must call!\r\n                      }\r\n                    );\r\n                  } \r\n                  else{                  \r\n                    event.completed(); //NOTE: Must call! \r\n                  }\r\n                });      \r\n              }\r\n              else {\r\n                console.error(`Error with item.notificationMessages.replaceAsync(): ${asyncResult4.error}`);\r\n              }\r\n            }\r\n          );\r\n        }\r\n      });\r\n    } else {\r\n      console.error(`Unexpected: asyncResult.status = ${asyncResult.status}`);\r\n      asyncResult.completed(); //NOTE: Must call!\r\n    }\r\n  });\r\n}\r\n/**\r\n * Method that fires when an attachment is being added or removed from the compose email or appointment\r\n * @param {Office.AsyncResult} result default: Office.AsyncResult\r\n */\r\nfunction onItemAttachmentsChangedHandler(event) {  \r\n  //TODO Test adding two or more attachments at the same time!\r\n  console.log(\"onItemAttachmentsChangedHandler: \" + event.attachmentDetails.name + \" (\" + event.attachmentStatus + \")\");\r\n  if (event.attachmentDetails.name == `${decryptedAttachmentPrefix}${fileName}`) {\r\n    //Don't process any more events - we've already encrypted the attachment and added it as another attachment, then decrypted that attachment and added it as well\r\n    event.completed(); //NOTE: Must call!\r\n    return;\r\n  }\r\n  if (fileName !== undefined){\r\n    console.log(\"Skipping processing of further attachments - demo is done!\");\r\n    event.completed(); //NOTE: Must call!\r\n    return;\r\n  }\r\n\r\n  //Process the first attachment. We'll encrypt it and add it as another attachment, then decrypted that attachment and add it as well\r\n  fileName = event.attachmentDetails.name;\r\n  var item = Office.context.mailbox.item;\r\n  var options = { asyncContext: { currentItem: item } };\r\n  item.getAttachmentsAsync(options, getAttachmentsCallback);\r\n}\r\n/**\r\n * Processes the attachments in the current item\r\n */\r\nfunction getAttachmentsCallback(result) {\r\n  if (result.value.length > 0) {\r\n    for (i = 0; i < result.value.length; i++) {\r\n      //https://docs.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#getAttachmentContentAsync_attachmentId__callback_\r\n      result.asyncContext.currentItem.getAttachmentContentAsync(result.value[i].id, handleAttachmentsCallback);\r\n    }\r\n  }\r\n}\r\n/**\r\n * Method that encrypts base64 file data using CryptoJS and attaches the file to the email. Cloud, .eml and .ICalendar attachments will not be processed.\r\n * @param {string} result default: Office.AsyncResult\r\n */\r\nfunction handleAttachmentsCallback(result) {\r\n  // Parse string to be a url, an .eml file, a base64-encoded string, or an .icalendar file.\r\n  console.log(`handleAttachmentsCallback(): result.value.format = ${result.value.format}`);\r\n  // console.dir(result.value.content); //NOTE: If you want to see the base64 data output to the console, uncomment this line\r\n\r\n  switch (result.value.format) {\r\n    case Office.MailboxEnums.AttachmentContentFormat.Base64:\r\n      // Handle file attachment\r\n\r\n      //BUG Something is wrong with this flow in Outlook for Windows - nothing fires after adding the ProgressIndicator message\r\n      //Set a notification message that we're processing the attachment. Note that this will be removed immediately after the decrypted attachment is added, and it may not be displayed for very long\r\n      var options = { 'asyncContext': { base64: result.value.content } };\r\n      Office.context.mailbox.item.notificationMessages.addAsync(\"processingAttachments\", {\r\n        type: Office.MailboxEnums.ItemNotificationMessageType.ProgressIndicator,\r\n        message: `Please wait while the '${fileName}' attachment is encrypted...`,\r\n      }, options, function(asyncResult){\r\n          //Encrypt base64 file data using CryptoJS\r\n          if (asyncResult.status === Office.AsyncResultStatus.Succeeded){\r\n            try {\r\n              var ciphertext = CryptoJS.AES.encrypt(asyncResult.asyncContext.base64, secretKey).toString();\r\n              //Then attaches the file to the email            \r\n              console.log(`handleAttachmentsCallback(): starting processing of file '${fileName}'...`);\r\n              encryptAttachment(ciphertext);            \r\n            }\r\n            catch(ex){\r\n              console.error(`handleAttachmentsCallback(): Error: ${ex}`);            \r\n              Office.context.mailbox.item.notificationMessages.removeAsync(\"processingAttachments\", function (result) {\r\n        console.log(\"Notification message removed.\");});\r\n            }            \r\n          }     \r\n          else{\r\n            console.error(`handleAttachmentsCallback(): Unexpected - status is ${asyncResult.status}`);            \r\n          }     \r\n      });      \r\n      break;\r\n\r\n      // //Encrypt base64 file data using CryptoJS\r\n      // var ciphertext = CryptoJS.AES.encrypt(result.value.content, secretKey).toString();\r\n      // //Then attaches the file to the email\r\n      // encryptAttachment(ciphertext);\r\n      // break;\r\n    case Office.MailboxEnums.AttachmentContentFormat.Eml:\r\n      // Handle email item attachment.\r\n      console.log(\"Attachment is a message.\");\r\n      break;\r\n    case Office.MailboxEnums.AttachmentContentFormat.ICalendar:\r\n      // Handle .icalender attachment.\r\n      console.log(\"Attachment is a calendar item.\");\r\n      break;\r\n    case Office.MailboxEnums.AttachmentContentFormat.Url:\r\n      // Handle cloud attachment.\r\n      console.log(\"Attachment is a cloud attachment.\");\r\n      break;\r\n    default:\r\n      // Handle attachment formats that are not supported.\r\n      console.log(\"Not handling unsupported attachment.\");\r\n      break;\r\n  }\r\n}\r\n/**\r\n * Method that converts encrypted data to base64 and creates and adds a file attachment to the current email\r\n * @param {string} encryptedData default: \"undefined\"\r\n */\r\nfunction encryptAttachment(encryptedData) {\r\n  console.log(`encryptAttachment(): Encrypting file '${fileName}''...`);\r\n  // console.dir(encryptedData); //NOTE: If you want to see the encrypted data output to the console, uncomment this line\r\n\r\n  var base64EncryptedData = window.btoa(encryptedData);\r\n  var encryptedFileName = `${encryptedAttachmentPrefix}${fileName}`;\r\n  //NOTE: If you want to see the base64 data output to the console, uncomment these lines\r\n  // console.log(\"encryptAttachment(): base64 encrypted data:\");\r\n  // console.dir(base64EncryptedData);\r\n\r\n  console.log(`encryptAttachment(): Adding encrypted file '${encryptedFileName}'...`);\r\n  Office.context.mailbox.item.addFileAttachmentFromBase64Async(\r\n    base64EncryptedData,\r\n    encryptedFileName,\r\n    function (asyncResult) {\r\n      console.log(`encryptAttachment(): Added encrypted attachment '${encryptedFileName}'; now decrypting...`);\r\n      //console.dir(asyncResult); //NOTE: If you want to see the base64 data output to the console, uncomment this line\r\n      decryptAttachment(encryptedData);\r\n    }\r\n  );\r\n}\r\n/**\r\n * Method that decrypts encrypted base64 file data using CryptoJS and attaches the file to the email\r\n * @param {string} encryptedData default: \"undefined\"\r\n */\r\nfunction decryptAttachment(encryptedData) {\r\n  console.log(`decryptAttachment(): Decrypting file '${fileName}''...`);\r\n\r\n  var bytes = CryptoJS.AES.decrypt(encryptedData, secretKey);\r\n  var originalText = bytes.toString(CryptoJS.enc.Utf8);\r\n  var decryptedFileName = `${decryptedAttachmentPrefix}${fileName}`;\r\n\r\n  // console.log(`decryptAttachment(): Original base64: ${originalText}`); //NOTE: If you want to see the base64 data output to the console, uncomment this line\r\n  console.log(`decryptAttachment(): Adding decrypted file '${decryptedFileName}'...`);\r\n  Office.context.mailbox.item.addFileAttachmentFromBase64Async(\r\n    originalText,\r\n    decryptedFileName,\r\n    function (asyncResult) {\r\n      console.log(`decryptAttachment(): Added decrypted attachment '${decryptedFileName}'`);\r\n      // console.dir(asyncResult); //NOTE: If you want to see the base64 data output to the console, uncomment this line\r\n\r\n      Office.context.mailbox.item.notificationMessages.removeAsync(\"processingAttachments\", function (result) {\r\n        console.log(\"Notification message removed.\");        \r\n\r\n        Office.context.mailbox.item.notificationMessages.addAsync(\"attachmentsAdded\", {\r\n          type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n          message: `The '${fileName}' attachment has been encrypted and decrypted and added as reference attachments for your review.`,\r\n          icon: \"Icon.16x16\",\r\n          persistent: false,\r\n        });\r\n      });\r\n    }\r\n  );\r\n}\r\n/**\r\n * Displays the InfoBar in the compose email. Purpose is to remind the user running this sample to open the Task Pane to display additional instructions and reference information\r\n */\r\nfunction showInfoBarForSampleInstructions() {\r\n  //NOTE: Clicking the \"Show Task Pane\" link in the InfoBar doesn't work. It is currently 'in backlog' status: https://github.com/OfficeDev/office-js/issues/2125\r\n  //NOTE: actions array only applicable to insightMessage types\r\n  //https://docs.microsoft.com/en-us/javascript/api/outlook/office.notificationmessages?view=outlook-js-preview\r\n  Office.context.mailbox.item.notificationMessages.addAsync(\"showInfoBarForSampleInstructions\", {\r\n    type: Office.MailboxEnums.ItemNotificationMessageType.InsightMessage, //\"insightMessage\"\r\n    message: \"Open the Task Pane for details about running the Outlook Event-based Activation Sample Add-in\",\r\n    icon: \"Icon.16x16\",\r\n    actions: [\r\n      {\r\n        actionText: \"Show Task Pane\",\r\n        actionType: Office.MailboxEnums.ActionType.ShowTaskPane, //\"showTaskPane\"\r\n        commandId: \"msgComposeOpenPaneButton\",\r\n        contextData: \"{''}\",\r\n      },\r\n    ],\r\n  });\r\n}\r\n/**\r\n * Method that fires when the user changes the date/time for an appointment\r\n * @param {string} result default: Office.AsyncResult\r\n */\r\nfunction onAppointmentTimeChangedHandler(event) {\r\n  //BUG Is this message preventing use of localStorage? Tracking Prevention blocked access to storage for https://appsforoffice.microsoft.com/lib/beta/hosted/office.js.\r\n  console.dir(event);\r\n  console.dir(event.type);\r\n  console.dir(event.start);\r\n  console.dir(event.end);\r\n\r\n  let originalAppointmentDate = JSON.parse(localStorage.getItem(\"appointment_info\"));\r\n  let originalAppointmentDateStartDate = new Date(originalAppointmentDate.start);\r\n  let originalAppointmentDateStartEnd = new Date(originalAppointmentDate.end);\r\n  let convertedToLocalStartUtc = Office.context.mailbox.convertToLocalClientTime(originalAppointmentDateStartDate);\r\n  let convertedToLocalEndUtc = Office.context.mailbox.convertToLocalClientTime(originalAppointmentDateStartEnd);\r\n  let convertedToLocalStart = new Date(\r\n    convertedToLocalStartUtc.year,\r\n    convertedToLocalStartUtc.month,\r\n    convertedToLocalStartUtc.date,\r\n    convertedToLocalStartUtc.hours,\r\n    convertedToLocalStartUtc.minutes\r\n  );\r\n  let convertedToLocalEnd = new Date(\r\n    convertedToLocalEndUtc.year,\r\n    convertedToLocalEndUtc.month,\r\n    convertedToLocalEndUtc.date,\r\n    convertedToLocalEndUtc.hours,\r\n    convertedToLocalEndUtc.minutes\r\n  );\r\n\r\n  Office.context.mailbox.item.notificationMessages.getAllAsync(function (asyncResult) {\r\n    console.log(`getAllAsync(): asyncResult.status = ${asyncResult.status}`);\r\n    if (asyncResult.status != \"failed\") {\r\n      for (let index = 0; index < asyncResult.value.length; index++) {\r\n        const element = asyncResult.value[index];\r\n        if (element.key === \"timeChanged\") {\r\n          //Only need to set the message once\r\n          event.completed;\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    var originalDateMessage = `Original date/time: Start = ${convertedToLocalStart.toLocaleDateString()} ${convertedToLocalStart.toLocaleTimeString()}; End = ${convertedToLocalEnd.toLocaleDateString()} ${convertedToLocalEnd.toLocaleTimeString()}`;\r\n    Office.context.mailbox.item.notificationMessages.replaceAsync(\r\n      \"timeChanged\",\r\n      {\r\n        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\r\n        message: originalDateMessage,\r\n        icon: \"Icon.16x16\",\r\n        persistent: false,\r\n      },\r\n      function (asyncResult) {\r\n        console.log(\"replaceAsync() for 'timeChanged' completed\");\r\n        console.dir(asyncResult);\r\n        dateStampMessageSet = true;\r\n        event.completed();\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n// 1st parameter: FunctionName of LaunchEvent in the manifest; 2nd parameter: Its implementation in this .js file.\r\nOffice.actions.associate(\"onMessageComposeHandler\", onMessageComposeHandler);\r\nOffice.actions.associate(\"onAppointmentComposeHandler\", onAppointmentComposeHandler);\r\nOffice.actions.associate(\"onMessageAttachmentsChangedHandler\", onItemAttachmentsChangedHandler);\r\nOffice.actions.associate(\"onAppointmentAttachmentsChangedHandler\", onItemAttachmentsChangedHandler);\r\nOffice.actions.associate(\"onAppointmentAttendeesChangedHandler\", onAppointmentAttendeesChangedHandler);\r\nOffice.actions.associate(\"onAppointmentTimeChangedHandler\", onAppointmentTimeChangedHandler);\r\n"],"sourceRoot":""}